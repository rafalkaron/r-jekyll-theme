{% assign postsByYear =
    site.posts | group_by_exp:"post", "post.date | date: '%Y'" %}
{% for year in postsByYear %}
{%- assign date_format = site.date_format | default:"%b %-d, %Y" -%}

<div id="post-list-container">
<h1 id="{{year.name | slugify }}"> {{ year.name }} </h1>
    {% for post in year.items %}
    <ul id="post-list">
    
        <li class="post-item">

            {%- if post.image -%}
            <img class="post-image" src="{{ post.image }}">
            {%- endif -%}

            <a href="{{ post.url }}" class="post-link"><h2 id="{{post.title | slugify }}">{{post.title}}</h2> </a>

            <div class="post-meta">
                <div class="post-info">
                    {%- if post.date -%}
                    <time class="post-published" datetime="{{ post.date | date_to_xmlschema }}" itemprop="datePublished">{{ post.date | date: date_format }}</time>
                    {%- endif -%}

                    {%- if post.modified_date -%}<span> ~ </span>
                    {%- assign mdate = post.modified_date | date_to_xmlschema -%}
                    <time class="post-modified" datetime="{{ mdate }}" itemprop="dateModified">{{ mdate | date: date_format }}</time>
                    {%- endif -%}

                    {%- if post.author -%}<span> â€¢ </span>
                    <span class="p-author h-card" itemprop="name">{{ post.author }}</span>
                    {% endif -%}

                    {%- if post.category -%}<span> | </span>
                    <span class="post-categories">
                        {% if post %}
                            {% assign categories = post.categories %}
                        {% else %}
                            {% assign categories = page.categories %}
                        {% endif %}
                        {% for category in categories %}
                        <a href="{{site.baseurl}}/blog/#{{category|slugize}}">{{category}}</a>
                        {% unless forloop.last %}&nbsp;{% endunless %}
                        {% endfor %}
                    </span>
                    {%- endif -%}
                </div>
                

                {%- if post.tags -%}
                <ul class="post-tags">
                {%- for tag in post.tags %}
                    <span class="post-categories">
                        {% if post %}
                            {% assign categories = post.categories %}
                        {% else %}
                            {% assign categories = page.categories %}
                        {% endif %}
                        {% for category in categories %}
                        <li class="post-tag"><a href="{{site.baseurl}}/blog/#{{tag|slugize}}">{{tag}}</a></li>
                        {% unless forloop.last %}&nbsp;{% endunless %}
                        {% endfor %}
                    </span>
                {%- endfor -%}
                {%- endif -%}
                </ul>

                {%- if post.excerpt -%}
                <div class="post-excerpt">{{post.excerpt}}</div>
                {%- endif -%}

            </div>

            <div class="read-more">
                <a href="{{ post.url }}" class="read-more-link"> Read more...</a>
            </div>

        </li>
    {% endfor %}
    </ul>
{% endfor %}
<div>